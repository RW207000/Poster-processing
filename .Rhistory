duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
labs_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/labs_wide.csv", header=T, na.strings= c("", "NA"))
# format date
labs_wide$Date <- as.Date(labs_wide$Date, format = "%d/%m/%Y")
typeof(labs_wide$Date)
knitr::opts_chunk$set(echo = TRUE)
participants <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Core only 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# participants$Date...CAH.Longitudinal.Data <- as.Date(participants$Date...CAH.Longitudinal.Data, format = "%d/%m/%Y")
medication <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Glucocorticoids Data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
medication <- remove_empty(medication, c("cols"), cutoff = 1)
# medication$assessment_date <- as.Date(medication$assessment_date, format = "%d/%m/%Y")
labs <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Labs data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# labs$assessment_date <- as.Date(labs$assessment_date, format = "%d/%m/%Y")
longitudinal <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Longitudinal data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
participants_longitudinal <- merge(participants, longitudinal, by = "CO.ID",
all = TRUE)
participants_longitudinal$Date.of.Assessment <- as.Date(participants_longitudinal$Date.of.Assessment, format = "%d/%m/%Y")
#make unique identifier
participants_longitudinal$CO.ID_assessment_date <- paste0(participants_longitudinal$CO.ID, participants_longitudinal$Date.of.Assessment)
write.csv(participants_longitudinal, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/participants_longitudinal.csv", row.names = F)
participants$coid_assedate <- paste(participants$CO.ID, participants$Date...CAH.Longitudinal.Data, sep = " ")
duplicates <- freq(participants$coid_assedate)
duplicatesframe <- as.data.frame(duplicates)
duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
labs_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/labs_wide.csv", header=T, na.strings= c("", "NA"))
# format date
meds_wide$Date.of.Assessment_1 <- as.Date(meds_wide$Date.of.Assessment_1, format = "%d-%m-%Y")
knitr::opts_chunk$set(echo = TRUE)
participants <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Core only 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# participants$Date...CAH.Longitudinal.Data <- as.Date(participants$Date...CAH.Longitudinal.Data, format = "%d/%m/%Y")
medication <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Glucocorticoids Data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
medication <- remove_empty(medication, c("cols"), cutoff = 1)
# medication$assessment_date <- as.Date(medication$assessment_date, format = "%d/%m/%Y")
labs <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Labs data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# labs$assessment_date <- as.Date(labs$assessment_date, format = "%d/%m/%Y")
longitudinal <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Longitudinal data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
participants_longitudinal <- merge(participants, longitudinal, by = "CO.ID",
all = TRUE)
participants_longitudinal$Date.of.Assessment <- as.Date(participants_longitudinal$Date.of.Assessment, format = "%d/%m/%Y")
#make unique identifier
participants_longitudinal$CO.ID_assessment_date <- paste0(participants_longitudinal$CO.ID, participants_longitudinal$Date.of.Assessment)
write.csv(participants_longitudinal, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/participants_longitudinal.csv", row.names = F)
participants$coid_assedate <- paste(participants$CO.ID, participants$Date...CAH.Longitudinal.Data, sep = " ")
duplicates <- freq(participants$coid_assedate)
duplicatesframe <- as.data.frame(duplicates)
duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
labs_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/labs_wide.csv", header=T, na.strings= c("", "NA"))
# format date
meds_wide$Date.of.Assessment_1 <- as.Date(meds_wide$Date.of.Assessment_1, format = "%Y-%m-%d")
View(minimal_data)
knitr::opts_chunk$set(echo = TRUE)
participants <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Core only 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# participants$Date...CAH.Longitudinal.Data <- as.Date(participants$Date...CAH.Longitudinal.Data, format = "%d/%m/%Y")
medication <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Glucocorticoids Data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
medication <- remove_empty(medication, c("cols"), cutoff = 1)
# medication$assessment_date <- as.Date(medication$assessment_date, format = "%d/%m/%Y")
labs <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Labs data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# labs$assessment_date <- as.Date(labs$assessment_date, format = "%d/%m/%Y")
longitudinal <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Longitudinal data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
participants_longitudinal <- merge(participants, longitudinal, by = "CO.ID",
all = TRUE)
participants_longitudinal$Date.of.Assessment <- as.Date(participants_longitudinal$Date.of.Assessment, format = "%d/%m/%Y")
#make unique identifier
participants_longitudinal$CO.ID_assessment_date <- paste0(participants_longitudinal$CO.ID, participants_longitudinal$Date.of.Assessment)
write.csv(participants_longitudinal, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/participants_longitudinal.csv", row.names = F)
participants$coid_assedate <- paste(participants$CO.ID, participants$Date...CAH.Longitudinal.Data, sep = " ")
duplicates <- freq(participants$coid_assedate)
duplicatesframe <- as.data.frame(duplicates)
duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
# format date
meds_wide$Date.of.Assessment_1 <- as.Date(meds_wide$Date.of.Assessment_1, format = "%Y-%m-%d")
# let's add unique identifier
meds_wide$CO.ID_assessment_date <- paste0(meds_wide$CO.ID, meds_wide$Date.of.Assessment_1)
labs_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/labs_wide.csv", header=T, na.strings= c("", "NA"))
# format date
labs_wide$Date <- as.Date(labs_wide$Date, format = "%d/%m/%Y")
# let's add unique identifier
labs_wide$CO.ID_assessment_date <- paste0(labs_wide$CO.ID, labs_wide$Date)
# identify and remove any duplicates
med_duplicates <- as.data.frame(freq(meds_wide$CO.ID_assessment_date))
View(med_duplicates)
View(med_duplicates)
med_duplicates <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date")
med_duplicates <- med_duplicates[med_duplicates$CO.ID_assessment_date ! = c("Total", "<NA>"),]
med_duplicates <- med_duplicates[med_duplicates$CO.ID_assessment_date != c("Total", "<NA>"),]
med_duplicates <- med_duplicates[-c(3:6)]
med_duplicates <- med_duplicates %>%
filter(Freq>1)
med_to_remove <- med_duplicates$CO.ID_assessment_date
meds_wide_no_duplicated <- subset(meds_wide, !CO.ID_assessment_date %in% med_to_remove)
meds_wide_no_duplicates <- subset(meds_wide, !CO.ID_assessment_date %in% med_to_remove)
med_freq_check <- as.data.frame(freq(meds_wide_no_duplicates$CO.ID_assessment_date))
med_freq_check <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date")
View(med_freq_check)
med_freq_check <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date2")
knitr::opts_chunk$set(echo = TRUE)
participants <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Core only 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# participants$Date...CAH.Longitudinal.Data <- as.Date(participants$Date...CAH.Longitudinal.Data, format = "%d/%m/%Y")
medication <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Glucocorticoids Data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
medication <- remove_empty(medication, c("cols"), cutoff = 1)
# medication$assessment_date <- as.Date(medication$assessment_date, format = "%d/%m/%Y")
labs <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Labs data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# labs$assessment_date <- as.Date(labs$assessment_date, format = "%d/%m/%Y")
longitudinal <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Longitudinal data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
participants_longitudinal <- merge(participants, longitudinal, by = "CO.ID",
all = TRUE)
participants_longitudinal$Date.of.Assessment <- as.Date(participants_longitudinal$Date.of.Assessment, format = "%d/%m/%Y")
#make unique identifier
participants_longitudinal$CO.ID_assessment_date <- paste0(participants_longitudinal$CO.ID, participants_longitudinal$Date.of.Assessment)
write.csv(participants_longitudinal, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/participants_longitudinal.csv", row.names = F)
participants$coid_assedate <- paste(participants$CO.ID, participants$Date...CAH.Longitudinal.Data, sep = " ")
duplicates <- freq(participants$coid_assedate)
duplicatesframe <- as.data.frame(duplicates)
duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
# format date
meds_wide$Date.of.Assessment_1 <- as.Date(meds_wide$Date.of.Assessment_1, format = "%Y-%m-%d")
# let's add unique identifier
meds_wide$CO.ID_assessment_date <- paste0(meds_wide$CO.ID, meds_wide$Date.of.Assessment_1)
# identify and remove any duplicates
med_duplicates <- as.data.frame(freq(meds_wide$CO.ID_assessment_date))
med_duplicates <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date")
med_duplicates <- med_duplicates[med_duplicates$CO.ID_assessment_date != c("Total", "<NA>"),]
med_duplicates <- med_duplicates[-c(3:6)]
med_duplicates <- med_duplicates %>%
filter(Freq>1)
med_to_remove <- med_duplicates$CO.ID_assessment_date
meds_wide_no_duplicates <- subset(meds_wide, !CO.ID_assessment_date %in% med_to_remove)
med_freq_check <- as.data.frame(freq(meds_wide_no_duplicates$CO.ID_assessment_date))
med_freq_check <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date2")
med_freq_check <- med_freq_check[med_freq_check$CO.ID_assessment_date != c("Total", "<NA>"),]
knitr::opts_chunk$set(echo = TRUE)
participants <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Core only 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# participants$Date...CAH.Longitudinal.Data <- as.Date(participants$Date...CAH.Longitudinal.Data, format = "%d/%m/%Y")
medication <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Glucocorticoids Data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
medication <- remove_empty(medication, c("cols"), cutoff = 1)
# medication$assessment_date <- as.Date(medication$assessment_date, format = "%d/%m/%Y")
labs <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Labs data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
# labs$assessment_date <- as.Date(labs$assessment_date, format = "%d/%m/%Y")
longitudinal <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/Longitudinal data 24.02.2025.csv", header=T, na.strings= c("", "NA"))
participants_longitudinal <- merge(participants, longitudinal, by = "CO.ID",
all = TRUE)
participants_longitudinal$Date.of.Assessment <- as.Date(participants_longitudinal$Date.of.Assessment, format = "%d/%m/%Y")
#make unique identifier
participants_longitudinal$CO.ID_assessment_date <- paste0(participants_longitudinal$CO.ID, participants_longitudinal$Date.of.Assessment)
write.csv(participants_longitudinal, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/data/participants_longitudinal.csv", row.names = F)
participants$coid_assedate <- paste(participants$CO.ID, participants$Date...CAH.Longitudinal.Data, sep = " ")
duplicates <- freq(participants$coid_assedate)
duplicatesframe <- as.data.frame(duplicates)
duplicatesframe <- rownames_to_column(duplicatesframe, var="idvisitdate")
duplicatesframe <- duplicatesframe[duplicatesframe$idvisitdate != c("Total", "<NA>"),]
duplicatesframe <- duplicatesframe[-c(3:6)]
duplicateassessments <- duplicatesframe %>%
filter(Freq>1)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
# freqcheck
toremove <- duplicateassessments$idvisitdate
removedrecords <- subset(participants, coid_assedate %in% toremove)
write.csv(removedrecords, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/removed_records", row.names = F)
duplicateassessments$id <- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 1)
duplicateassessments$visitdate<- sapply(strsplit(duplicateassessments$idvisitdate," "), `[`, 2)
toremovelostparticipants <- participantsnoduplicates$CO.ID
lostparticipants <- NA
lostparticipants <- subset(participants, !CO.ID %in% toremovelostparticipants)
write.csv(lostparticipants, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/lostparticipants.csv", row.names = F)
idvisitstoremove <- duplicateassessments$idvisitdate
participantsnoduplicates <- subset(participants, !coid_assedate %in% idvisitstoremove)
freqcheck <- as.data.frame(freq(participantsnoduplicates$coid_assedate))
freqcheck <- rownames_to_column(freqcheck, var="idvisitdate")
freqcheck <- freqcheck[freqcheck$idvisitdate != c("Total", "<NA>"),]
centres <-as.data.frame(unique(participants_longitudinal$Centre.ID.x))
centres <- centres %>%
rename("Centre ID" = "unique(participants_longitudinal$Centre.ID.x)")
print("There are")
length(centres$`Centre ID`)
print("centres")
patients_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n_unique(CO.ID)) %>%
as.data.frame() %>%
rename("number of patients" = "n_unique(CO.ID)")
visits_per_centre <- participants_longitudinal %>%
group_by(Centre.ID.x) %>%
summarise(n = n()) %>%
rename("number of visits" = "n")
centre_stats <- full_join(patients_per_centre, visits_per_centre, by = "Centre.ID.x")
write.csv(centre_stats, file = "C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/centre_stats.csv", row.names = F)
minimal_data <- select(participants_longitudinal, c("CO.ID_assessment_date", "CO.ID", "Centre.ID.x", "Date.of.Birth.y", "Sex.at.birth.x", "Date.of.Assessment", "Weight..kg.", "Height..cm.", "BMI", "Systolic.Blood.Pressure", "Diastolic.Blood.Pressure"))
minimal_data <- minimal_data %>%
rename("Centre ID" = "Centre.ID.x",
"DOB" = "Date.of.Birth.y",
"Sex" = "Sex.at.birth.x",
"Date of assessment" = "Date.of.Assessment",
"Weight.Kg" = "Weight..kg.",
"Height.cm" = "Height..cm.")
# start by making DOB and assessment date date formats
minimal_data$DOB <- as.Date(minimal_data$DOB, format = "%d/%m/%Y")
minimal_data$`Date of assessment` <- as.Date(minimal_data$`Date of assessment`, format = "%d/%m/%Y")
minimal_data$`Age at assessment (years)` <- interval(minimal_data$DOB, minimal_data$`Date of assessment`) / years(1)
minimal_data$`Age at assessment (years)` <- round(minimal_data$`Age at assessment (years)`, digits = 0)
meds_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/meds_wide.csv", header=T, na.strings= c("", "NA"))
# format date
meds_wide$Date.of.Assessment_1 <- as.Date(meds_wide$Date.of.Assessment_1, format = "%Y-%m-%d")
# let's add unique identifier
meds_wide$CO.ID_assessment_date <- paste0(meds_wide$CO.ID, meds_wide$Date.of.Assessment_1)
# identify and remove any duplicates
med_duplicates <- as.data.frame(freq(meds_wide$CO.ID_assessment_date))
med_duplicates <- rownames_to_column(med_duplicates, var="CO.ID_assessment_date")
med_duplicates <- med_duplicates[med_duplicates$CO.ID_assessment_date != c("Total", "<NA>"),]
med_duplicates <- med_duplicates[-c(3:6)]
med_duplicates <- med_duplicates %>%
filter(Freq>1)
med_to_remove <- med_duplicates$CO.ID_assessment_date
meds_wide_no_duplicates <- subset(meds_wide, !CO.ID_assessment_date %in% med_to_remove)
med_freq_check <- as.data.frame(freq(meds_wide_no_duplicates$CO.ID_assessment_date))
# identify and remove any duplicates
lab_duplicates <- as.data.frame(freq(labs_wide$CO.ID_assessment_date))
labs_wide <- read.csv("C:/Users/md1rwe/Documents/Data extractions from I-CAH/Feb 2025/I-CAH_data_Feb_2025/outputs/labs_wide.csv", header=T, na.strings= c("", "NA"))
# format date
labs_wide$Date <- as.Date(labs_wide$Date, format = "%d/%m/%Y")
# let's add unique identifier
labs_wide$CO.ID_assessment_date <- paste0(labs_wide$CO.ID, labs_wide$Date)
# identify and remove any duplicates
lab_duplicates <- as.data.frame(freq(labs_wide$CO.ID_assessment_date))
lab_duplicates <- rownames_to_column(lab_duplicates, var="CO.ID_assessment_date")
lab_duplicates <- lab_duplicates[lab_duplicates$CO.ID_assessment_date != c("Total", "<NA>"),]
lab_duplicates <- lab_duplicates[-c(3:6)]
lab_duplicates <- lab_duplicates %>%
filter(Freq>1)
lab_to_remove <- lab_duplicates$CO.ID_assessment_date
labs_wide_no_duplicates <- subset(labs_wide, !CO.ID_assessment_date %in% lab_to_remove)
# all frequencies here should be 1
lab_freq_check <- as.data.frame(freq(labs_wide_no_duplicates$CO.ID_assessment_date))
View(lab_freq_check)
